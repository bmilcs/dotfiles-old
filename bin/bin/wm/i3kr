#!/usr/bin/env bash
#  ▄▄▄▄· • ▌ ▄ ·. ▪  ▄▄▌   ▄▄· .▄▄ ·   ──────────────────────
#  ▐█ ▀█▪·██ ▐███▪██ ██•  ▐█ ▌▪▐█ ▀.   ╔╦╗╔═╗╔╦╗╔═╗╦╦  ╔═╗╔═╗
#  ▐█▀▀█▄▐█ ▌▐▌▐█·▐█·██ ▪ ██ ▄▄▄▀▀▀█▄   ║║║ ║ ║ ╠╣ ║║  ║╣ ╚═╗
#  ██▄▪▐███ ██▌▐█▌▐█▌▐█▌ ▄▐███▌▐█▄▪▐█  ═╩╝╚═╝ ╩ ╚  ╩╩═╝╚═╝╚═╝
#  ·▀▀▀▀ ▀▀  █▪▀▀▀▀▀▀.▀▀▀ ·▀▀▀  ▀▀▀▀   https://dot.bmilcs.com
#                 I3 KILL > FOCUS > LAUNCH [./i3killfocrun]
#────────────────────────────────────────────────────────────
source _bm

usage() { 
  ( _oc $(basename $0) 
  _oy   -n   name
  _oy   -c   cmd
  _o    -f   config) 1>&2; exit 1; 
}

while getopts "n:c:f" opt; do
    case "${opt}" in
        n) name=${OPTARG} ;;
        c) cmd=${OPTARG} ;;
        f) cfg="1" ;;
        *) usage
            ;;
    esac
done

if [ -z "${name}" ] || [ -z "${cmd}" ]; then
    usage
fi


if [ "$(pgrep -fc "$name")" -eq 1  ]; then
  if [ -n "$cfg" ]; then
    alacritty --class="$name" --title="$name" --config-file=/home/bmilcs/bm/opt/alacritty/.config/alacritty/floating.yml -e "$cmd" &
  else
    alacritty --class="$name" --title="$name" -e "$cmd &"
  fi
else
  xdotool windowkill "$(xdotool search --name "$name")"
fi
