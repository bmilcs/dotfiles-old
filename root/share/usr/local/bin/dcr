#!/bin/bash
source _head
set -e

echo -e "${PUR}• ${BLU}docker-compose update ${NC}"
cd ~/docker || _e "~/docker missing!" && exit 1
docker-compose up -d --remove-orphans

/usr/bin/git --git-dir=$HOME/docker/.git/ --work-tree=$HOME/docker \
  commit -a -m "automated update" \
  && /usr/bin/git --git-dir=/home/bmilcs/docker/.git/ \
  --work-tree=/home/bmilcs/docker push \
  && echo -e "  ${GRN}[√] done.${NC}\n"

# rm -rf /tmp/docker
# git clone git@github.com:bmilcs/docker.git /tmp/docker
# rm -f ~/docker/docker-compose.yaml ~/docker/.env
# cp /tmp/docker/1docker-compose.yaml /tmp/docker/.env ~/docker/
# cd ~/docker
# mv ~/docker/1docker-compose.yaml ~/docker/docker-compose.yaml
